{% extends "base.html" %}

{% block content %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Список задач</title>
    <!-- Подключение стилей Bootstrap -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
</head>
<body>
<div class="container">
    <h1>Список задач</h1>
    <a href="{% url 'create_task' %}" class="btn btn-primary">Добавить задачу</a>
    <!-- Меню сортировки -->
    <div class="mb-3">
        Сортировать по:
        <a href="?order_by=title" class="btn btn-light btn-sm">Названию</a>
        <a href="?order_by=due_date" class="btn btn-light btn-sm">Дате завершения</a>
        <a href="?order_by=priority" class="btn btn-light btn-sm">Приоритету</a>
    </div>
    <table class="table table-striped">
        <thead>
        <tr>
            <th>Заголовок</th>
            <th>Приоритет</th>
            <th>Действия</th>
        </tr>
        </thead>
        <tbody>
        {% for task in tasks %}
        <tr>
            <td><a href="{% url 'task_detail' task.pk %}">{{ task.title }}</a>
                <p> {{ task.created_at|date:"d/m/Y" }} в {{ task.created_at|time:"H:i" }}</p></td>

            <td>

                <p>Приоритет: {{ task.get_priority_display }}</p>
            <td>
                {% if task.is_completed %}
                <span class="badge badge-success">Выполнено</span>
                {% else %}
                <a href="{% url 'toggle_completion' task.id %}" class="btn btn-success">Отметить как выполненное</a>
                {% endif %}
                <a href="{% url 'update_task' task.pk %}" class="btn btn-warning">Редактировать</a>
                <a href="{% url 'delete_task' task.pk %}" class="btn btn-danger">Удалить</a>
                {% if task in favorite_tasks %}
                <a href="{% url 'toggle_favorite' task.id %}" class="btn btn-secondary">Убрать из избранного</a>
                {% else %}
                <a href="{% url 'toggle_favorite' task.id %}" class="btn btn-secondary">Добавить в избранное</a>
                {% endif %}
            </td>
        </tr>
        {% endfor %}
        </tbody>
    </table>
</div>
</body>
</html>

{% endblock %}